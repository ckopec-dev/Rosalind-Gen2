# Rosalind Problem: Find a Profile-most Probable k-mer in a String

## Problem Description
Given a string Text, an integer k, and a 4 × k matrix Profile, we want to find a k-mer in Text that is most likely to have been generated by the profile.

## Solution in Perl

```perl
#!/usr/bin/perl
use strict;
use warnings;

# Function to find the profile-most probable k-mer
sub profile_most_probable_kmer {
    my ($text, $k, $profile) = @_;
    
    my $max_prob = 0;
    my $most_probable_kmer = "";
    
    # Iterate through all possible k-mers in the text
    for my $i (0..length($text) - $k) {
        my $kmer = substr($text, $i, $k);
        my $prob = calculate_probability($kmer, $profile);
        
        if ($prob > $max_prob) {
            $max_prob = $prob;
            $most_probable_kmer = $kmer;
        }
    }
    
    return $most_probable_kmer;
}

# Function to calculate probability of a k-mer given the profile
sub calculate_probability {
    my ($kmer, $profile) = @_;
    
    my $prob = 1;
    
    for my $i (0..length($kmer) - 1) {
        my $nucleotide = substr($kmer, $i, 1);
        my $position = $i;
        
        # Convert nucleotide to index (A=0, C=1, G=2, T=3)
        my $index;
        if ($nucleotide eq 'A') {
            $index = 0;
        } elsif ($nucleotide eq 'C') {
            $index = 1;
        } elsif ($nucleotide eq 'G') {
            $index = 2;
        } elsif ($nucleotide eq 'T') {
            $index = 3;
        }
        
        # Multiply by the probability from the profile
        $prob *= $profile->[$index][$position];
    }
    
    return $prob;
}

# Main execution
sub main {
    # Read input from stdin or file
    my $text = <STDIN>;
    chomp $text;
    
    my $k = <STDIN>;
    chomp $k;
    
    # Read profile matrix
    my @profile;
    for my $i (0..3) {
        my $line = <STDIN>;
        chomp $line;
        my @row = split /\s+/, $line;
        $profile[$i] = \@row;
    }
    
    # Find and print the result
    my $result = profile_most_probable_kmer($text, $k, \@profile);
    print "$result\n";
}

# Run main function
main();
```

## Example Usage

**Input:**
```
ACGTACGT
3
0.1 0.2 0.3 0.4
0.2 0.3 0.4 0.1
0.3 0.4 0.1 0.2
0.4 0.1 0.2 0.3
```

**Output:**
```
ACG
```

## Explanation

1. **Input parsing**: The program reads the DNA string, k value, and the 4×k profile matrix
2. **Sliding window**: It examines each possible k-mer in the string using a sliding window approach
3. **Probability calculation**: For each k-mer, it calculates the probability using the profile matrix
4. **Maximum selection**: It keeps track of the k-mer with the highest probability
5. **Output**: Returns the profile-most probable k-mer

## Key Features

- Handles the 4×k profile matrix where rows represent nucleotides (A, C, G, T) and columns represent positions
- Uses a sliding window to examine all possible k-mers in the input string
- Calculates probability by multiplying individual nucleotide probabilities
- Returns the k-mer with maximum probability

## Time Complexity
O(n×k) where n is the length of the text and k is the k-mer length

## Space Complexity
O(1) additional space (excluding input storage)

